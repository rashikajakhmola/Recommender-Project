tbl %>% group_by(animal,price) %>% summarise(count=n()) %>% arrange(desc(count)) %>% ungroup()
retail %>%
filter(Quantity <= 0) %>%
group_by(Description, UnitPrice) %>%
summarise(count =n()) %>%
arrange(desc(count)) %>%
ungroup()
retail  <- retail %>%
filter(Quantity > 0)
retail$StockCode
stc <- c('AMAZONFEE', 'BANK CHARGES', 'C2', 'DCGSSBOY',     'DCGSSGIRL', 'DOT', 'gift_0001_', 'PADS', 'POST')
paste(stc, collapse="|")
retail %>%
filter(grepl(paste(stc, collapse="|"), StockCode))  %>%
group_by(StockCode, Description) %>%
summarise(count =n()) %>%
arrange(desc(count)) %>%
ungroup()
retail <- filter(retail,
!grepl(paste(stc, collapse="|"), StockCode))
tbl
fav <- "Pig"
fav %in% tbl$animal
tbl$animal %in% fav
a <- c(1,2,3,4,5,NA,6)
a %>% is.na
descr <- c( "check", "check?", "?", "??", "damaged", "found",
"adjustment", "Amazon", "AMAZON", "amazon adjust",
"Amazon Adjustment", "amazon sales", "Found", "FOUND",
"found box", "Found by jackie ","Found in w/hse","dotcom",
"dotcom adjust", "allocate stock for dotcom orders ta", "FBA", "Dotcomgiftshop Gift Voucher £100.00", "on cargo order",
"wrongly sold (22719) barcode", "wrongly marked 23343",
"dotcomstock", "rcvd be air temp fix for dotcom sit",
"Manual", "John Lewis", "had been put aside",
"for online retail orders", "taig adjust", "amazon",
"incorrectly credited C550456 see 47", "returned",
"wrongly coded 20713", "came coded as 20713",
"add stock to allocate online orders", "Adjust bad debt",
"alan hodge cant mamage this section", "website fixed",
"did  a credit  and did not tick ret", "michel oops",
"incorrectly credited C550456 see 47", "mailout", "test",
"Sale error",  "Lighthouse Trading zero invc incorr", "SAMPLES",
"Marked as 23343", "wrongly coded 23343","Adjustment",
"rcvd be air temp fix for dotcom sit", "Had been put aside." )
retail <- retail %>%
filter(!(Description %in% descr))
sum(is.na(retail$Description))
retail <- retail %>%
filter(!is.na(Description))
retail$CustomerID %>% skim()
sapply(retail[ ,c('InvoiceNo','CustomerID')],
function(x) length(unique(x)))
retail <- retail %>%
mutate(Description = as.factor(Description)) %>%
mutate(Country = as.factor(Country)) %>%
mutate(InvoiceNo = as.numeric(InvoiceNo)) %>%
mutate(Date = as.Date(InvoiceDate)) %>%
mutate(Time = as.factor(format(InvoiceDate,"%H:%M:%S")))
retail <- retail %>%
mutate(InNo_Desc = paste(InvoiceNo, Description, sep = ' '))
retail <- retail[!duplicated(retail$InNo_Desc), ] %>%
select(-InNo_Desc)
ratings_matrix <- retail %>%
select(InvoiceNo, Description) %>%
mutate(value = 1) %>%
spread(Description, value, fill = 0) %>%
select(-InvoiceNo) %>%
as.matrix() %>%
as("binaryRatingMatrix")
# install.packages("data.table")
# install.packages("readxl")
# install.packages("tidyverse")
# install.packages("lubridate")
# install.packages("skimr")
# install.packages("knitr")
# install.packages("treemap")
# install.packages("installr")
install.packages("recommenderlab")
#
# library(installr)
#
# updateR()
#Getting Libraries
library(data.table)
library(readxl)
library(tidyverse)
library(lubridate)
library(skimr)
library(knitr)
library(treemap)
library(recommenderlab)
ratings_matrix <- retail %>%
select(InvoiceNo, Description) %>%
mutate(value = 1) %>%
spread(Description, value, fill = 0) %>%
select(-InvoiceNo) %>%
as.matrix() %>%
as("binaryRatingMatrix")
scheme <- ratings_matrix %>%
evaluationScheme(method = "cross",
k      = 5,
train  = 0.8,
given  = -1)
scheme
algorithms <- list(
"association rules" = list(name  = "AR",
param = list(supp = 0.01, conf = 0.01)),
"random items"      = list(name  = "RANDOM",  param = NULL),
"popular items"     = list(name  = "POPULAR", param = NULL),
"item-based CF"     = list(name  = "IBCF", param = list(k = 5)),
"user-based CF"     = list(name  = "UBCF",
param = list(method = "Cosine", nn = 500))
)
algorithms
results <- recommenderlab::evaluate(scheme,
algorithms,
type  = "topNList",
n     = c(1, 3, 5, 10, 15, 20)
)
results
retail %>%
group_by(Description) %>%
summarize(count = n()) %>%
top_n(10, wt = count) %>%
arrange(desc(count)) %>%
ggplot(aes(x = reorder(Description, count), y = count))+
geom_bar(stat = "identity", fill = "royalblue", colour = "blue") +
labs(x = "", y = "Top 10 Best Sellers", title = "Most Ordered Products") +
coord_flip() +
theme_grey(base_size = 12)
retail %>%
group_by(Description) %>%
summarize(count = n()) %>%
mutate(pct=(count/sum(count))*100) %>%
arrange(desc(pct)) %>%
ungroup() %>%
top_n(10, wt=pct)
retail %>%
group_by(Description) %>%
summarize(count = n()) %>%
mutate(pct=(count/sum(count))*100) %>%
arrange(desc(pct)) %>%
ungroup() %>%
top_n(10, wt=pct)
retail %>%
ggplot(aes(hour(hms(Time)))) +
geom_histogram(stat = "count",fill = "#E69F00", colour = "red") +
labs(x = "Hour of Day", y = "") +
theme_grey(base_size = 12)
# install.packages("data.table")
# install.packages("readxl")
# install.packages("tidyverse")
# install.packages("lubridate")
# install.packages("skimr")
# install.packages("knitr")
# install.packages("treemap")
# install.packages("installr")
# install.packages("recommenderlab")
install.packages("ggplot2")
#
# library(installr)
#
# updateR()
#Getting Libraries
library(data.table)
library(readxl)
library(tidyverse)
library(lubridate)
library(skimr)
library(knitr)
library(treemap)
library(recommenderlab)
# install.packages("data.table")
# install.packages("readxl")
# install.packages("tidyverse")
# install.packages("lubridate")
# install.packages("skimr")
# install.packages("knitr")
# install.packages("treemap")
# install.packages("installr")
# install.packages("recommenderlab")
install.packages("ggplot2")
#
# library(installr)
#
# updateR()
#Getting Libraries
# library(data.table)
# library(readxl)
# library(tidyverse)
# library(lubridate)
# library(skimr)
# library(knitr)
# library(treemap)
# library(recommenderlab)
install.packages("ggplot2")
#Getting Libraries
# library(data.table)
# library(readxl)
# library(tidyverse)
# library(lubridate)
# library(skimr)
# library(knitr)
# library(treemap)
# library(recommenderlab)
library(ggplot2)
retail %>%
group_by(Description) %>%
summarize(count = n()) %>%
top_n(10, wt = count) %>%
arrange(desc(count)) %>%
ggplot(aes(x = reorder(Description, count), y = count))+
geom_bar(stat = "identity", fill = "royalblue", colour = "blue") +
labs(x = "", y = "Top 10 Best Sellers", title = "Most Ordered Products") +
coord_flip() +
theme_grey(base_size = 12)
retail %>%
group_by(Description) %>%
summarize(count = n()) %>%
top_n(10, wt = count) %>%
arrange(desc(count)) %>%
ggplot(aes(x = reorder(Description, count), y = count))+
geom_bar(stat = "identity", fill = "royalblue", colour = "blue") +
labs(x = "", y = "Top 10 Best Sellers", title = "Most Ordered Products") +
coord_flip() +
theme_grey(base_size = 12)
library(ggplot2)
retail %>%
group_by(Description) %>%
summarize(count = n()) %>%
top_n(10, wt = count) %>%
arrange(desc(count)) %>%
ggplot(aes(x = reorder(Description, count), y = count))+
geom_bar(stat = "identity", fill = "royalblue", colour = "blue") +
labs(x = "", y = "Top 10 Best Sellers", title = "Most Ordered Products") +
coord_flip() +
theme_grey(base_size = 12)
library(ggplot2)
retail %>%
group_by(Description) %>%
summarise(count = n()) %>%
top_n(10, wt = count) %>%
arrange(desc(count)) %>%
ggplot(aes(x = reorder(Description, count), y = count))+
geom_bar(stat = "identity", fill = "royalblue", colour = "blue") +
labs(x = "", y = "Top 10 Best Sellers", title = "Most Ordered Products") +
coord_flip() +
theme_grey(base_size = 12)
library(ggplot2)
retail %>%
group_by(Description) %>%
summarize(count = n()) %>%
top_n(10, wt = count) %>%
arrange(desc(count)) %>%
ggplot(aes(x = reorder(Description, count), y = count))+
geom_bar(stat = "identity", fill = "royalblue", colour = "blue") +
labs(x = "", y = "Top 10 Best Sellers", title = "Most Ordered Products") +
coord_flip() +
theme_grey(base_size = 12)
retail %>%
group_by(Description) %>%
summarize(count = n()) %>%
top_n(10, wt = count) %>%
arrange(desc(count)) %>%
ggplot(aes(x = reorder(Description, count), y = count))+
geom_bar(stat = "identity", fill = "royalblue", colour = "blue") +
labs(x = "", y = "Top 10 Best Sellers", title = "Most Ordered Products") +
coord_flip() +
theme_grey(base_size = 12)
dev.off()
retail %>%
group_by(Description) %>%
summarize(count = n()) %>%
top_n(10, wt = count) %>%
arrange(desc(count)) %>%
ggplot(aes(x = reorder(Description, count), y = count))+
geom_bar(stat = "identity", fill = "royalblue", colour = "blue") +
labs(x = "", y = "Top 10 Best Sellers", title = "Most Ordered Products") +
coord_flip() +
theme_grey(base_size = 12)
retail %>%
ggplot(aes(hour(hms(Time)))) +
geom_histogram(stat = "count",fill = "#E69F00", colour = "red") +
labs(x = "Hour of Day", y = "") +
theme_grey(base_size = 12)
{r,echo=TRUE}
retail %>%
ggplot(aes(hour(hms(Time)))) +
geom_histogram(stat = "count",fill = "#E69F00", colour = "red") +
labs(x = "Hour of Day", y = "") +
theme_grey(base_size = 12)
retail %>%
ggplot(aes(wday(Date,
week_start = getOption("lubridate.week.start", 1)))) +
geom_histogram(stat = "count" , fill = "forest green", colour = "dark green") +
labs(x = "Day of Week", y = "") +
scale_x_continuous(breaks = c(1,2,3,4,5,6,7),
labels = c("Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun")) +
theme_grey(base_size = 14)
retail %>%
ggplot(aes(hour(hms(Time)))) +
geom_histogram(stat = "count",fill = "#E69F00", colour = "red") +
labs(x = "Hour of Day", y = "") +
theme_grey(base_size = 12)
save.image()
knitr::opts_chunk$set(echo = T)
retail %>%
group_by(Description) %>%
summarize(count = n()) %>%
top_n(10, wt = count) %>%
arrange(desc(count)) %>%
ggplot(aes(x = reorder(Description, count), y = count))+
geom_bar(stat = "identity", fill = "royalblue", colour = "blue") +
labs(x = "", y = "Top 10 Best Sellers", title = "Most Ordered Products") +
coord_flip() +
theme_grey(base_size = 12)
knitr::opts_chunk$set(echo = T)
# install.packages("data.table")
# install.packages("readxl")
# install.packages("tidyverse")
# install.packages("lubridate")
# install.packages("skimr")
# install.packages("knitr")
# install.packages("treemap")
# install.packages("installr")
# install.packages("recommenderlab")
install.packages("ggplot2")
#
# library(installr)
#
# updateR()
#Getting Libraries
# library(data.table)
# library(readxl)
# library(tidyverse)
# library(lubridate)
# library(skimr)
# library(knitr)
# library(treemap)
# library(recommenderlab)
library(ggplot2)
retail <- read_excel("Online Retail.xlsx",
trim_ws = TRUE)
knitr::opts_chunk$set(echo = T)
install.packages("data.table")
knitr::opts_chunk$set(echo = T)
install.packages("data.table")
install.packages("readxl")
install.packages("tidyverse")
install.packages("lubridate")
install.packages("data.table")
install.packages("readxl")
knitr::opts_chunk$set(echo = T)
install.packages("data.table")
install.packages("readxl")
install.packages("tidyverse")
install.packages("lubridate")
install.packages("skimr")
install.packages("data.table")
knitr::opts_chunk$set(echo = T)
install.packages("data.table")
install.packages("readxl")
#Getting Libraries
library(data.table)
library(readxl)
library(tidyverse)
knitr::opts_chunk$set(echo = T)
# install.packages("data.table")
# install.packages("readxl")
# install.packages("tidyverse")
# install.packages("lubridate")
# install.packages("skimr")
# install.packages("knitr")
# install.packages("treemap")
# install.packages("installr")
# install.packages("recommenderlab")
#
# library(installr)
#
# updateR()
#Getting Libraries
library(data.table)
library(readxl)
library(tidyverse)
library(lubridate)
library(skimr)
library(knitr)
library(treemap)
library(recommenderlab)
retail <- read_excel("Online Retail.xlsx",
trim_ws = TRUE)
retail %>% skim()
# a <- c(1,2,3,4) %>% as.data.frame()
# b <- c(T,T,F,T)
# a %>% filter(b)
grepl("Italy", retail$Country) %>% table()
retail %>%
filter(grepl("C", retail$InvoiceNo)) %>%
summarise(Total = n())
retail  <- retail %>%
filter(!grepl("C", retail$InvoiceNo))
# a <- c("Ant","Bat","Cow","Pig","Pig","Genda","Genda")
# b <- c(1,1,1,1,2,1,1)
# tbl <- cbind(a,b) %>% as.data.frame()
# colnames(tbl) <- c("animal","price")
# tbl %>% group_by(price) %>% summarise(count=n())
# tbl %>% group_by(animal) %>% summarise(count=n())
# tbl %>% group_by(animal,price) %>% summarise(count=n())
# tbl %>% group_by(animal,price) %>% summarise(count=n()) %>% arrange(desc(count))
# tbl %>% group_by(animal,price) %>% summarise(count=n()) %>% arrange(desc(count)) %>% ungroup()
retail %>%
filter(Quantity <= 0) %>%
group_by(Description, UnitPrice) %>%
summarise(count =n()) %>%
arrange(desc(count)) %>%
ungroup()
retail  <- retail %>%
filter(Quantity > 0)
retail$StockCode
stc <- c('AMAZONFEE', 'BANK CHARGES', 'C2', 'DCGSSBOY',     'DCGSSGIRL', 'DOT', 'gift_0001_', 'PADS', 'POST')
paste(stc, collapse="|")
retail %>%
filter(grepl(paste(stc, collapse="|"), StockCode))  %>%
group_by(StockCode, Description) %>%
summarise(count =n()) %>%
arrange(desc(count)) %>%
ungroup()
retail <- filter(retail,
!grepl(paste(stc, collapse="|"), StockCode))
# tbl
# fav <- "Pig"
# fav %in% tbl$animal
# tbl$animal %in% fav
# a <- c(1,2,3,4,5,NA,6)
# a %>% is.na
descr <- c( "check", "check?", "?", "??", "damaged", "found",
"adjustment", "Amazon", "AMAZON", "amazon adjust",
"Amazon Adjustment", "amazon sales", "Found", "FOUND",
"found box", "Found by jackie ","Found in w/hse","dotcom",
"dotcom adjust", "allocate stock for dotcom orders ta", "FBA", "Dotcomgiftshop Gift Voucher £100.00", "on cargo order",
"wrongly sold (22719) barcode", "wrongly marked 23343",
"dotcomstock", "rcvd be air temp fix for dotcom sit",
"Manual", "John Lewis", "had been put aside",
"for online retail orders", "taig adjust", "amazon",
"incorrectly credited C550456 see 47", "returned",
"wrongly coded 20713", "came coded as 20713",
"add stock to allocate online orders", "Adjust bad debt",
"alan hodge cant mamage this section", "website fixed",
"did  a credit  and did not tick ret", "michel oops",
"incorrectly credited C550456 see 47", "mailout", "test",
"Sale error",  "Lighthouse Trading zero invc incorr", "SAMPLES",
"Marked as 23343", "wrongly coded 23343","Adjustment",
"rcvd be air temp fix for dotcom sit", "Had been put aside." )
retail <- retail %>%
filter(!(Description %in% descr))
sum(is.na(retail$Description))
retail <- retail %>%
filter(!is.na(Description))
retail$CustomerID %>% skim()
sapply(retail[ ,c('InvoiceNo','CustomerID')],
function(x) length(unique(x)))
retail <- retail %>%
mutate(Description = as.factor(Description)) %>%
mutate(Country = as.factor(Country)) %>%
mutate(InvoiceNo = as.numeric(InvoiceNo)) %>%
mutate(Date = as.Date(InvoiceDate)) %>%
mutate(Time = as.factor(format(InvoiceDate,"%H:%M:%S")))
retail %>%
group_by(Description) %>%
summarize(count = n()) %>%
top_n(10, wt = count) %>%
arrange(desc(count)) %>%
ggplot(aes(x = reorder(Description, count), y = count))+
geom_bar(stat = "identity", fill = "royalblue", colour = "blue") +
labs(x = "", y = "Top 10 Best Sellers", title = "Most Ordered Products") +
coord_flip() +
theme_grey(base_size = 12)
knitr::opts_chunk$set(echo = T)
retail %>%
group_by(Description) %>%
summarize(count = n()) %>%
top_n(10, wt = count) %>%
arrange(desc(count)) %>%
ggplot(aes(x = reorder(Description, count), y = count))+
geom_bar(stat = "identity", fill = "royalblue", colour = "blue") +
labs(x = "", y = "Top 10 Best Sellers", title = "Most Ordered Products") +
coord_flip() +
theme_grey(base_size = 12)
dev.off()
retail %>%
group_by(Description) %>%
summarize(count = n()) %>%
top_n(10, wt = count) %>%
arrange(desc(count)) %>%
ggplot(aes(x = reorder(Description, count), y = count))+
geom_bar(stat = "identity", fill = "royalblue", colour = "blue") +
labs(x = "", y = "Top 10 Best Sellers", title = "Most Ordered Products") +
coord_flip() +
theme_grey(base_size = 12)
retail %>%
group_by(Description) %>%
summarize(count = n()) %>%
top_n(10, wt = count) %>%
arrange(desc(count)) %>%
ggplot(aes(x = reorder(Description, count), y = count))+
geom_bar(stat = "identity", fill = "royalblue", colour = "blue") +
labs(x = "", y = "Top 10 Best Sellers", title = "Most Ordered Products") +
coord_flip() +
theme_grey(base_size = 12)
tmp <- results$`user-based CF` %>%
getConfusionMatrix()  %>%
as.list()
